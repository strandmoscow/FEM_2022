import osimport numpy as npfrom jinja2 import Environment, FileSystemLoaderimport matplotlib.pyplot as pltauthor_name="{Шашко Олег Владимирович}"author_name_short="{Шашко О. В.}"group="{РК6-71б}"variant="{23}"a = 1.0b = 0.0c = -15.0d = 4.0min_int = 3.0min_cond_type = 0min_value = 10.0max_int = 14.0max_cond_type = 1max_value = 1.0an_sol_for_c = "(exp(-sqrt(15.) * (x + 3.)) * (146. * exp(2. * sqrt(15.) * x) + 4. * exp(sqrt(15.) * (x + 3.)) + 4. * exp(sqrt(15.) * (x + 25.)) + sqrt(15) * exp(sqrt(15.) * (2. * x + 11.)) - sqrt(15.) * exp(17. * sqrt(15.)) + 146. * exp(28. * sqrt(15.)))) / (15. * (1. + exp(22. * sqrt(15.))))"analytical_solution = "\\begin{multline}\\frac{1}{15\\left(1+e^{22 \\sqrt{15}}\\right)} \\\\ e^{-\\sqrt{15}(x+3)}\\left(146 e^{2 \\sqrt{15} x}+4 e^{\\sqrt{15}(x+3)}+4 e^{\\sqrt{15}(x+25)}+\\sqrt{15} e^{\\sqrt{15}(2 x+11)}-\\right. \\left.\\quad \\sqrt{15} e^{17 \\sqrt{15}}+146 e^{28 \\sqrt{15}}\\right)\\end{multline}"# Jinja initenvironment = Environment(    loader=FileSystemLoader("templates/"))base_template = environment.get_template("labs/educmm_txb_COMPMATHLAB-Solution_N_M/educmm_lab_Variant_N_M-id.tex")base_res_file_name = f"res/labs/educmm_txb_COMPMATHLAB-Solution_N_M/educmm_lab_Variant_N_M-id.tex"base_text = base_template.render(    author_name=author_name,    author_name_short=author_name_short,    group=group,    variant=variant)code_tempate_lin = environment.get_template("code/lin.cc")code_file_name_lin_20 = f"code/lin_20/code_lin_20.cc"code_lin_20 = code_tempate_lin.render(    elem=20,    a=a,    b=b,    c=c,    d=d,    min_int=min_int,    min_cond_type=min_cond_type,    min_value=min_value,    max_int=max_int,    max_cond_type=max_cond_type,    max_value=max_value,    lin = "true",    an_sol_for_c = an_sol_for_c)code_file_name_lin_40 = f"code/lin_40/code_lin_40.cc"code_lin_40 = code_tempate_lin.render(    elem=40,    a=a,    b=b,    c=c,    d=d,    min_int=min_int,    min_cond_type=min_cond_type,    min_value=min_value,    max_int=max_int,    max_cond_type=max_cond_type,    max_value=max_value,    lin = "true",    an_sol_for_c = an_sol_for_c)code_file_name_cub_20 = f"code/cub_20/code_cub_20.cc"code_cub_20 = code_tempate_lin.render(    elem=20,    a=a,    b=b,    c=c,    d=d,    min_int=min_int,    min_cond_type=min_cond_type,    min_value=min_value,    max_int=max_int,    max_cond_type=max_cond_type,    max_value=max_value,    lin = "false",    an_sol_for_c = an_sol_for_c)code_file_name_cub_40 = f"code/cub_40/code_cub_40.cc"code_cub_40 = code_tempate_lin.render(    elem=40,    a=a,    b=b,    c=c,    d=d,    min_int=min_int,    min_cond_type=min_cond_type,    min_value=min_value,    max_int=max_int,    max_cond_type=max_cond_type,    max_value=max_value,    lin="false",    an_sol_for_c=an_sol_for_c)with open(base_res_file_name, mode="w+", encoding="utf-8") as base:    base.write(base_text)    print(f"... wrote {base_res_file_name}")with open(code_file_name_lin_20, mode="w+", encoding="utf-8") as code_lin_20_file:    code_lin_20_file.write(code_lin_20)    print(f"... wrote {code_file_name_lin_20}")with open(code_file_name_lin_40, mode="w+", encoding="utf-8") as code_lin_40_file:    code_lin_40_file.write(code_lin_40)    print(f"... wrote {code_file_name_lin_40}")with open(code_file_name_cub_20, mode="w+", encoding="utf-8") as code_cub_20_file:    code_cub_20_file.write(code_cub_20)    print(f"... wrote {code_file_name_cub_20}")with open(code_file_name_cub_40, mode="w+", encoding="utf-8") as code_cub_40_file:    code_cub_40_file.write(code_cub_40)    print(f"... wrote {code_file_name_cub_40}")os.system("g++ -o c20.exe D:\FEM_2022\code\cub_20\code_cub_20.cc -std=c++11")os.system("move c20.exe D:\FEM_2022\code\cub_20")os.system("g++ -o c40.exe D:\FEM_2022\code\cub_40\code_cub_40.cc -std=c++11")os.system("move c40.exe D:\FEM_2022\code\cub_40")os.system("g++ -o l20.exe D:\FEM_2022\code\lin_20\code_lin_20.cc -std=c++11")os.system("move l20.exe D:\FEM_2022\code\lin_20")os.system("g++ -o l40.exe D:\FEM_2022\code\lin_40\code_lin_40.cc -std=c++11")os.system("move l40.exe D:\FEM_2022\code\lin_40")os.system("D:\FEM_2022\code\cub_20\c20.exe")os.system("D:\FEM_2022\code\cub_40\c40.exe")os.system("D:\FEM_2022\code\lin_20\l20.exe")os.system("D:\FEM_2022\code\lin_40\l40.exe")# Matplotfig, ax = plt.subplots()absolute = np.loadtxt('res/labs/text/graph/abs.txt')x_abs = absolute[:, 0]y_abs = absolute[:, 1]# "lin_20.txt", "lin_40.txt", "cub_20.txt", "cub_40.txt"result_files = [{'name': "cub_20.txt", 'save_to': "res/labs/img/cub/20.png"},                {'name': "cub_40.txt", 'save_to': "res/labs/img/cub/40.png"},                {'name': "lin_20.txt", 'save_to': "res/labs/img/lin/20.png"},                {'name': "lin_40.txt", 'save_to': "res/labs/img/lin/40.png"}]for file in result_files:    absolute = np.loadtxt('res/labs/text/graph/' + file['name'])    x = absolute[:, 0]    y = absolute[:, 1]    ax.set(xlabel='X', ylabel='U')    ax.plot(x, y, 'r-', label='МКЭ')    ax.plot(x_abs, y_abs, 'b-', label='Аналитическое решение')    ax.grid()    ax.legend()    fig.savefig(file['save_to'])    plt.cla()with open('res/labs/text/pgr/cub_20.txt', 'r') as f:    pogr_num = float(f.read())code_tempate_pogr = environment.get_template("code/pogr.cc")code_file_name_pogr = f"code/pogr/pogr.cc"code_pogr = code_tempate_pogr.render(    elem=20,    a=a,    b=b,    c=c,    d=d,    min_int=min_int,    min_cond_type=min_cond_type,    min_value=min_value,    max_int=max_int,    max_cond_type=max_cond_type,    max_value=max_value,    lin = "true",    an_sol_for_c = an_sol_for_c,    cube=pogr_num)with open(code_file_name_pogr, mode="w+", encoding="utf-8") as code_pogr_file:    code_pogr_file.write(code_pogr)    print(f"... wrote {code_file_name_pogr}")os.system("g++ -o pogr.exe D:\FEM_2022\code\pogr\pogr.cc -std=c++11")os.system("move pogr.exe D:\FEM_2022\code\pogr")os.system("D:\FEM_2022\code\pogr\pogr.exe")base_template = environment.get_template("labs/educmm_txb_COMPMATHLAB-Solution_N_M.tex")latex_text_file_name = f"res/labs/educmm_txb_COMPMATHLAB-Solution_N_M.tex"latex_text = base_template.render(    a=a,    a_int=int(a),    a_abs=abs(int(a)),    b=b,    b_int=int(b),    b_abs=abs(int(b)),    c=c,    c_int=int(c),    c_abs=abs(int(c)),    d=d,    d_int=int(d),    d_abs=abs(int(d)),    min_int = min_int,    min_int_int = int(min_int),    min_cond_type = min_cond_type,    min_value = min_value,    min_value_int = int(min_value),    max_int = max_int,    max_int_int = int(max_int),    max_cond_type = max_cond_type,    max_value = max_value,    max_value_int = int(max_value),    analytical_solution = analytical_solution,    an_sol_for_c = an_sol_for_c,    code=code_lin_20)with open(latex_text_file_name, mode="w+", encoding="utf-8") as tex:    tex.write(latex_text)    print(f"... wrote {latex_text_file_name}")